# Домашнее задание к занятию «Защита сети»

### ` Дмитрий Климов `

## Задание 1

Проведите разведку системы и определите, какие сетевые службы запущены на защищаемой системе:

sudo nmap -sA < ip-адрес >

sudo nmap -sT < ip-адрес >

sudo nmap -sS < ip-адрес >

sudo nmap -sV < ip-адрес >

По желанию можете поэкспериментировать с опциями: https://nmap.org/man/ru/man-briefoptions.html.

В качестве ответа пришлите события, которые попали в логи Suricata и Fail2Ban, прокомментируйте результат.

## Ответ:

<img width="1920" height="1080" alt="Снимок экрана (1235)" src="https://github.com/user-attachments/assets/536d1538-35ec-4c22-87aa-1732a869bfa8" />

<img width="1920" height="1080" alt="Снимок экрана (1237)" src="https://github.com/user-attachments/assets/7a42a04a-c91a-4717-885d-efddf90a2620" />

<img width="1920" height="1080" alt="Снимок экрана (1238)" src="https://github.com/user-attachments/assets/9aedbf02-0044-4bc3-b0b1-46ff19c12b98" />

<img width="1920" height="1080" alt="Снимок экрана (1239)" src="https://github.com/user-attachments/assets/955d72a5-4d65-4569-b4e4-b610e01ad80b" />


## Комментарий:

Suricata успешно обнаружила признаки сканирования портов с IP-адреса 192.168.0.118. События ET SCAN указывают на то, что злоумышленник пытается обнаружить распространенные службы, такие как MySQL, VNC, Oracle SQL, MSSQL и PostgreSQL. Событие ET SCAN NMAP OS Detection Probe подтверждает, что nmap пытался определить операционную систему защищаемой системы.

Fail2Ban не предпринял никаких действий, поскольку сканирование портов само по себе не является достаточным основанием для блокировки IP-адреса в стандартной конфигурации Fail2Ban. Fail2Ban, как правило, требует неудачных попыток аутентификации, чтобы заблокировать IP-адрес.

## Вывод:

Разведка системы с помощью nmap предоставила информацию о потенциальных службах, работающих на защищаемой системе. Suricata смогла успешно обнаружить попытку сканирования портов и определение операционной системы. Для усиления защиты необходимо обновить программное обеспечение, использовать надежные пароли и настроить межсетевой экран, чтобы разрешать только необходимый трафик. В дальнейших заданиях можно будет рассмотреть настройку Fail2Ban для блокировки IP-адресов, генерирующих подозрительный трафик.




## Задание 2

Проведите атаку на подбор пароля для службы SSH:

hydra -L users.txt -P pass.txt < ip-адрес > ssh

### Настройка hydra:
создайте два файла: users.txt и pass.txt;
в каждой строчке первого файла должны быть имена пользователей, второго — пароли. В нашем случае это могут быть случайные строки, но ради эксперимента можете добавить имя и пароль существующего пользователя.
Дополнительная информация по hydra: https://kali.tools/?p=1847.

### Включение защиты SSH для Fail2Ban:
открыть файл /etc/fail2ban/jail.conf,
найти секцию ssh,
установить enabled в true.
Дополнительная информация по Fail2Ban:https://putty.org.ru/articles/fail2ban-ssh.html.

В качестве ответа пришлите события, которые попали в логи Suricata и Fail2Ban, прокомментируйте результат.

## Ответ:

### `` hydra работает с остановкой Fail2Ban ``

<img width="1920" height="1080" alt="Снимок экрана (1252)" src="https://github.com/user-attachments/assets/8599946e-cf75-4445-a6ad-1da3bf2d5afa" />

### `` Атака перебором паролей SSH и проверка работы Fail2Ban и Suricata ``

<img width="1920" height="1080" alt="Снимок экрана (1253)" src="https://github.com/user-attachments/assets/f309b7e1-21c8-46bf-a59c-6c3e9fb58bdc" />

<img width="1920" height="1080" alt="Снимок экрана (1254)" src="https://github.com/user-attachments/assets/c51c35f1-b97f-499f-8b8d-15cb20782ebd" />

<img width="1920" height="1080" alt="Снимок экрана (1255)" src="https://github.com/user-attachments/assets/99e2d7d6-8e14-41cd-8caf-55b57ef357a0" />



## Результаты:

Fail2Ban успешно заблокировал IP-адрес атакующей машины (192.168.0.118).
В логах Fail2Ban были обнаружены записи о блокировке IP-адреса.
Suricata обнаружила трафик, похожий на сканер SSH, и зарегистрировала события ET SCAN Potential SSH Scanи SURICATA STREAM excessive retransmissions.



## Вывод:

Fail2Ban эффективно защищает от атак перебором паролей SSH.
Suricata может обнаружить контакты кабеля SSH, но для более точного обнаружения атаки при переборе паролей могут применяться более специализированные правила.
Настройка верхних инструментов (Fail2Ban и Suricata) обеспечивает многоуровневую защиту от атак. Fail2Ban блокирует IP-адреса, а Suricata предоставляет информацию о характере атаки.
